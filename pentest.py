import requests
import os
import random
import string
import json

# Pen test a contact form to check if captcha or recaptcha is working
# example from https://youtu.be/UtNYzv8gLbs

# Python String interpolation https://www.programiz.com/python-programming/string-interpolation
# Python Slicing Lists https://railsware.com/blog/python-for-machine-learning-indexing-and-slicing-for-lists-tuples-strings-and-other-sequential-types/
# Load Python scripts in the repl and examine types and variables https://stackoverflow.com/questions/5280178/how-do-i-load-a-file-into-the-python-console
# Chrome developer tools shortcut swift + ctr + j

""" Interactive mode using the python repl
	python 
	>> import pentest *
	>> type(names)    // explore variable types, print etc 
 """

chars = string.ascii_letters + string.digits + '!@#$%^&*()'
random.seed = (os.urandom(1024))

with open('form_data.txt') as f:
	url = f.readline().rstrip()

names_list = json.loads(open('names.json').read())
names = names_list[:1] # take the first 10 names

for name in names:
	name_extra = ''.join(random.choice(string.digits))

	email = name.lower() + name_extra + '@gmail.com'
	fullname = name.lower()+''.join(random.choice(chars) for i in range(4))
	
	# not used now
	# password = ''.join(random.choice(chars) for i in range(8))
	form_data = {
		'your-name': fullname,
		'your-email': email,
		'your-subject': 'subject',
		'your-message': 'message',
		'wpgdprc': '1'
		}

	requests.post(url, allow_redirects = False, data = form_data)
	
	# String interpolation style 1
	# print("sending username %s and password %s" %(fullname, email))
	
	print(f"sending username {fullname} and password {email}")


print("exit")
